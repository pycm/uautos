function date2Text(date) {
    var result,
        now = new Date(),
        diff = now - date,
        ranges = {};

    ranges.minute = 1000 * 60;
    ranges.hour = ranges.minute * 60;
    ranges.day = ranges.hour * 24;
    ranges.week = ranges.day * 7;
    ranges.month = ranges.day * 30;
    ranges.year = ranges.day * 365.25;

    Object.keys(ranges).reverse().forEach(function(rangeName) {
        var count,
            rangeLength = ranges[rangeName];

        if (!result) {
            if (diff > rangeLength) {
                count = Math.floor(diff / rangeLength);

                result = count + ' ' + rangeName + (count > 1 ? 's' : '') + ' ago';
            }
        }
    });

    if (!result) {
        result = 'less than a minute ago';
    }

    return result;
}

module.exports = {
    process: date2Text
}